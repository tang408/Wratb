<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">


    <!-- <link href="App_Themes/map/css/bootstrap.css" rel="stylesheet" type="text/css" /> -->
    <link href="App_Themes/map/css/ol.css" rel="stylesheet" type="text/css" />
    <link href="App_Themes/map/css/tm-ol.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
        /*
        設定框選extent的樣式
        */
        .ol-dragbox {
            box-sizing: border-box;
            border-radius: 2px;
            border: 2px solid #FF9900;
        }

        .ol-dragzoom {
            box-sizing: border-box;
            border-radius: 2px;
            border: 2px solid #0000FF;
        }
    </style>
    <style type="text/css">
        .nano {
            background: #ffffff;
            width: 100%;
            height: 550px;
        }

        .nano>.nano-content {
            padding: 10px;
        }

        .nano>.nano-pane {
            background: rgba(255, 255, 255, .5);
            width: 8px;
        }

        /* 設定捲軸背景底色, 寬度 */
        .nano>.nano-pane>.nano-slider {
            background: rgba(0, 0, 0, .15);
        }

        /* 設定捲軸顏色 */
        body {
            background-color: #000000;
        }

        /* 地圖style */
        .map {
            width: 100%;
            position: relative;
            height: 100%;
        }

        /* 
        feature popup視窗 style
        */
        .ol-popup {
            position: absolute;
            background-color: white;
            -webkit-filter: drop-shadow(0 1px 4px rgba(0, 0, 0, 0.2));
            filter: drop-shadow(0 1px 4px rgba(0, 0, 0, 0.2));
            border-radius: 10px;
            border: 1px solid #cccccc;
            bottom: 44px;
            left: -48px;
        }

        .ol-popup:after,
        .ol-popup:before {
            top: 100%;
            border: solid transparent;
            content: " ";
            height: 0;
            width: 0;
            position: absolute;
            pointer-events: none;
        }

        .ol-popup:after {
            border-top-color: white;
            border-width: 10px;
            left: 48px;
            margin-left: -10px;
        }

        .ol-popup:before {
            border-top-color: #cccccc;
            border-width: 11px;
            left: 48px;
            margin-left: -11px;
        }

        .ol-popup-closer {
            text-decoration: none;
            position: absolute;
            top: 2px;
            right: 8px;
        }

        .ol-popup-closer:after {
            content: "✖";
        }

        .custom-mouse-position {
            width: 164px;
            height: 20px;
            white-space: nowrap;
        }

        .no-close .ui-dialog-titlebar-close {
            display: none;
        }
    </style>
    <!-- measure style -->
    <style type="text/css">
        .tooltip {
            position: relative;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            color: white;
            padding: 4px 8px;
            opacity: 0.7;
            filter: alpha(opacity=70);
            white-space: nowrap;
        }

        .tooltip-measure {
            opacity: 1;
            font-weight: bold;
        }

        .tooltip-static {
            background-color: #ffcc33;
            color: black;
            border: 1px solid white;
        }

        .tooltip-measure:before,
        .tooltip-static:before {
            border-top: 6px solid rgba(0, 0, 0, 0.5);
            border-right: 6px solid transparent;
            border-left: 6px solid transparent;
            content: "";
            position: absolute;
            bottom: -6px;
            margin-left: -7px;
            left: 50%;
        }

        .tooltip-static:before {
            border-top-color: #ffcc33;
        }
    </style>
</head>

<body>
    <form method="post" action="./Map.aspx" id="form1">
        <div class="aspNetHidden">
            <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE"
                value="8YTFAmmGXp0xY4ZnQw0TjSTUuOBOKTg/mN3fkBJgp+xr8B3bpcQ6I0QARWmy/IlngOCMm07+tlxO+6cQPFUSFl6VQ9ukaMiMpDfbSEITHPk=">
        </div>

        <div class="aspNetHidden">
            <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="B2654881">
        </div>
        <div>
        </div>
    </form>
    <div class="container">
        <div id="map" class="map" style="background-color: #FFFFFF;">
            <!--content結尾-->
            <div id="_default_bubble_" class="ol-popup">
                <div class="BtnFunc">
                    <ul>
                        <li class="close"><a href="#">關閉</a></li>
                    </ul>
                </div>
                <!--關閉+說明-->
                <div id="popup-content" class="MapBubbleStyle">
                </div>
            </div>
            <div id="menu" class="ol-popup Bubble">
                <div class="BtnFunc" style="float: right">
                    <ul>
                        <li class="close"><a href="javascript:void(0);ovMenu.setMap(null);">關閉</a></li>
                    </ul>
                </div>
                <!--關閉+說明-->
                <div id="menu-content" class="MapBubbleStyle" style="width: 360px;">
                </div>
            </div>
            <div id="mouse-position">
            </div>
            <table id="tableCaptureExtent"
                style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; z-index: 9; pointer-events: none; display: none;">
                <tr>
                    <td style="text-align: center; vertical-align: middle;">
                        <div id="divCaptureExtent"
                            style="width: 1024px; height: 768px; border: 2px solid blue; display: inline-block">
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <div class="map_menu box-close">
            <div>
                <button class="toggle"></button>
            </div>

            <div id="mapnav" class="mapnav">
                <ul>
                    <li class="nav_00"><a href="javascript:void(0);toolSwitch('fullMap')">計畫範圍</a></li>
                    <li class="nav_01"><a href="javascript:void(0);toolSwitch('baseMap')">底圖切換</a></li>
                    <li class="nav_05"><a href="javascript:void(0);toolSwitch('legend')">圖層套疊</a></li>
                    <li class="nav_08"><a href="javascript:void(0);toolSwitch('decisionInfo')">決策資訊</a></li>
                    <li class="nav_07"><a href="javascript:void(0);toolSwitch('closeAll');clearAllMark();">關閉全部</a></li>
                    <!--<li class="nav_06"><a href="javascript:void(0);toolSwitch('imageCapture')" id="export-png">匯出</a></li>-->
                    <!--<li class="nav_04"><a href="javascript:void(0);toolSwitch('locate')">定位</a></li>-->
                    <!--<li class="nav_03"><a href="javascript:void(0);toolSwitch('rangeQuery')">範圍查詢</a></li>-->
                    <!--<li class="nav_02"><a href="javascript:void(0);toolSwitch('measure')">量測</a></li>-->
                    <%--<li class="nav_01"><a href="javascript:void(0);toolSwitch('baseMap')">底圖切換</a></li>--%>
                        <li style="display: none" class="nav_99"><a
                                href="javascript:void(0);toolSwitch('backMis')">返回</a>
                        </li>
                </ul>
            </div>

        </div>
        <div class="map_cont">
            <!--內容-->
            <div class="FuncBox" style="display: none;">
                <!--箭頭-->
                <div id="contentBox" class="Box">
                    <iframe id="ifBox01" src="Map/baseMap.htm"
                        style="width: 100%; height: 100%; display: none;"></iframe>
                    <!--<iframe id="ifBox02" src="Map/measure.htm" style="width: 100%; height: 100%; display: none;">
                </iframe>-->
                    <!--<iframe id="ifBox03" src="Map/rangeQuery.htm" style="width: 100%; height: 100%; display: none;">
                </iframe>-->
                    <!--<iframe id="ifBox04" src="Map/locate.htm" style="width: 100%; height: 100%; display: none;">
                </iframe>-->
                    <iframe id="ifBox05" src="Map/legend.htm"
                        style="width: 100%; height: 100%; display: none;"></iframe>
                    <!--<iframe id="ifBox06" src="Map/imageCapture.htm" style="width: 100%; height: 100%;
                    display: none;"></iframe>-->
                    <iframe id="ifBox08" src="" style="width: 100%; height: 100%; display: none;"></iframe>
                </div>
            </div>
            <!--內容結尾-->
        </div>
        <div id="largeInfo" class="map_cont"
            style="position: absolute; left: 380px; top: 60px; width: 500px; height: 500px; display: none;">
            <iframe id="largeInfoFrame" style="width: 100%; height: 100%" frameborder="0"
                src="Map/decisionInfo_TBD.htm"></iframe>
        </div>
        <div id="helper" class="modal fade" role="dialog">
            <div class="Popup modal-dialog" role="document">
                <div class="modal-content">
                    <div class="BtnFunc modal-header">
                        <ul>
                            <li style="float: left">
                                <h1>HELP</h1>
                            </li>
                            <li class="close" data-dismiss="modal" aria-label="Close"><a
                                    style="margin-top: 8px; margin-right: -10px;"
                                    href="javascript:void(0);$('#helper').modal('hide');">關閉</a>
                            </li>
                        </ul>
                    </div>
                    <!--關閉+說明-->
                    <div class="modal-body">
                        <div id="helpContent">
                            • 請平移地圖，將要匯出的範圍移動至範圍內
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="featureDetail" class="modal fade" role="dialog">
            <div class="Popup modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="BtnFunc modal-header">
                        <ul>
                            <li style="float: left">
                                <h1>&nbsp;
                                </h1>
                            </li>
                            <li class="close" data-dismiss="modal" aria-label="Close"><a
                                    style="margin-top: 8px; margin-right: -10px;"
                                    href="javascript:void(0);$('#featureDetail').modal('hide');">關閉</a> </li>
                        </ul>
                    </div>
                    <!--關閉+說明-->
                    <div class="modal-body">
                        <div id="featureDetailContent">
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

</body>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
<script src="script/map_custom/tbd_vars.ashx" type="text/javascript"></script>
<script src="script/map_custom/map_base.js"></script>
<script src="Script/Highcharts/highcharts.js" type="text/javascript"></script>

<script src="Script/map/jquery.easyui.min.js" type="text/javascript"></script>
<script src="script/map/proj4.js" type="text/javascript"></script>
<script src="script/map_custom/pro4_defs.js" type="text/javascript"></script>

<script src="script/map/ol-debug.js" type="text/javascript"></script>

<!-- 以下順序不可改 -->
<script src="script/map_custom/map_vars.js" type="text/javascript"></script>
<script src="Script/map_custom/LayerStyles.js" type="text/javascript"></script>
<script src="script/map_custom/map_layers.js" type="text/javascript"></script>
<!-- ============ -->

<script src="script/map/ImageFilter.js" type="text/javascript"></script>

<script src="script/map/tm_openlayers_plugin.js" type="text/javascript"></script>
<script src="script/map/tm_openlayers_measure.js" type="text/javascript"></script>
<script src="script/map/tm_openlayers_locate.js" type="text/javascript"></script>
<script src="script/map/tm_openlayers_layer_manager.js" type="text/javascript"></script>
<script src="script/map/tm_ol3_editor.js" type="text/javascript"></script>
<script src="script/map_custom/page_func.js" type="text/javascript"></script>
<script src="script/map_custom/map_init.js" type="text/javascript"></script>
<script src="Script/map_custom/FeatureDetailContentGenerator.js" type="text/javascript"></script>
<script src="Script/map/jquery-ui.min.js" type="text/javascript"></script>


<!-- <script type="text/javascript">
    var locatedFeature;
    $.support.cors = true;
    var resizeInterval =
        setInterval(resizeMap, 500);
    function resizeMap() {
        var $map = $(".map");
        if ($map.length > 0) {
            $map.height($("html").height());
            map.updateSize();
            //$("#contentBox").height($("html").height() - 49);
            clearInterval(resizeInterval);
            resizeInterval = null;
            var $iframes = $("#contentBox iframe");
            for (var i = 0; i < $iframes.length; i++) {
                var cWin = $iframes[i].contentWindow;
                if (cWin && cWin.resizeLayout) {
                    cWin.resizeLayout();
                }
            }
        }
        resizeLargeInfo();
    }

    $(window).on("resize", function () {
        clearInterval(resizeInterval);
        resizeInterval = setInterval(resizeMap, 500);
    });
</script> -->
<script type="text/javascript">
    var isLargeInfoExpand = false;
    function expandLargeInfo() {
        isLargeInfoExpand = true;
        resizeLargeInfo();
    }
    function shrinkLargeInfo() {
        isLargeInfoExpand = false;
        $("#largeInfo").width(500);
    }
    function resizeLargeInfo() {
        if (isLargeInfoExpand) {
            var newWidth = $("html").width() - 20 - $(".map_cont:eq(1)").width() - $("#mouse-position").width() - 13 - 10;
            if (newWidth != $("#largeInfo").width()) {
                $("#largeInfo").width(newWidth);
            }
        }
    }
</script>
<script type="text/javascript">

    function setStationValue(data) {
        for (var i = 0; i < data.length; i++) {
            if (data[i]["ID"] == stationID) {
                var theDate = new Date(data[i]["Time"] + "+0800");
                if (isNaN(theDate.getDate())) {
                    theDate = new Date(data[i]["Time"]);
                }
                $waterQualityConent.append(
                    "<span style='padding:2px; text-align:left;'>" + data[i]["Concentration"] + " PPM </span>"
                    + "<br> 資料時間:" + (theDate.getYear() - 11) + "/" + (theDate.getMonth() + 1) + "/" + theDate.getDate() + " " + theDate.getHours() + ":" + theDate.getMinutes());
                break;
            }
        }
    }
</script>

<script type="text/javascript">
    mapInit();
</script>

</html>